{"version":3,"file":"cs1-game-socket.min.js","sources":["../../src/engine/modules/utils.js","../../src/engine/modules/socket.js"],"sourcesContent":["export const utils = {\n  \n  loadScript: function (url){\n\treturn new Promise(function(resolve, reject){\n\t\tvar head = document.getElementsByTagName('head')[0]\n\t\tvar script = document.createElement('script')\n\t\tscript.type = 'text/javascript'\n\t\tscript.addEventListener('load', function(){\n\t\t\tthis.removeEventListener('load', this)\n\t\t\tresolve(script)\n\t\t})\n\t\tscript.src = url\n\t\thead.appendChild(script)\n\t})\n}\n  \n  \n}","import {utils} from './utils'\n\n\nfunction setup(){\n  \n  CS1.socket = io()\n  \n  let s = CS1.socket\n    \n  s.on('connect',()=>{\n    console.log('CS1 Game Server Socket Established.')\n      \n    if(s.authid){\n      \n      s.emit('reauth',socket.authid);\n      s.id = socket.authid;\n      console.log('Emitting reauth!');\n      console.log('socket.id : ',s.id);\n      console.log('socket.playerData : ');\n      console.log(s.playerData);\n      console.log('socket.lastPlayerData : ');\n      console.log(s.lastPlayerData);\n      s.isInitialized = true;\n      \n    }else{\n      \n      s.playerData = {position:{},rotation:{},faceIndex:0};\n      s.lastPlayerData = {position:{},rotation:{},faceIndex:0};\n      //REVISIT\n      CS1.game.login = (un,pw)=>{\n        s.emit('login',{name:un,pw:pw});\n       }  \n      \n    }\n    \n    \n    \n  })\n    \n\n  s.on('disconnect', ()=>{\n    console.log('I have disconnected.');\n  });\n  \n\n  s.on('new-player', newPlayerObject=>{\n    if(CS1.debug)console.log('New player object received: ', newPlayerObject);\n    if(CS1.game.hasBegun && newPlayerObject.id != CS1.socket.id) {\n      setTimeout(()=>{CS1.say(`${newPlayerObject.name} has joined the game!`)},1000);\n      CS1.__addOtherPlayer(newPlayerObject);\n    }\n  });\n    \n \n  s.on('failed-socket',()=>{\n    window.location.reload();\n  });\n    \n  s.on('login-results',data=>{\n    if(data.success) {\n      //document.querySelector('#login').style.zIndex = -1;\n      //document.querySelector('#login').style.display = 'none'; \n      //document.querySelector('#login').setAttribute('hidden','');\n      //CS1.myPlayer.name = data.name;\n      CS1.scene.clock.start();\n      s.authid=s.id;\n    }\n    else {\n       //document.getElementById('login-msg').innerHTML = data.msg;\n      console.error(data.msg);\n     }\n  });\n  \n  s.on('log',msg=>{console.log(msg)});\n  \n  s.on('say',data=>{\n    CS1.say(data.msg,data.name);\n  });\n  \n    \n    \n  \n  \n  \n  \n}\n\n\n\nif( typeof io=='undefined'){\n    \n     utils.loadScript('/socket.io/socket.io.js')\n      .then(e=>{ setup() })\n    \n  }else{\n    \n     setup();\n    \n  }"],"names":[],"mappings":"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"}