{"version":3,"file":"cs1-game.min.js","sources":["../../src/game/main.js"],"sourcesContent":["AFRAME.registerSystem(\"trail\", {\n  schema: {},\n  init: function() {},\n  trails: { haveTrails: [] },\n  createTrail: function createTrail(\n    object,\n    length,\n    width,\n    resolution,\n    color,\n    offset\n  ) {\n    if (resolution > length) {\n      resolution = length;\n    }\n    if (!object.userData.trails) object.userData.trails = [];\n    const trail = {\n      length: Math.round(length),\n      width: width,\n      resolution: Math.round(resolution),\n      trailHistory: [],\n      trailVertices: [],\n      worldDirection: new THREE.Vector3()\n    };\n    object.userData.trails.push(trail);\n    var geometry = new THREE.PlaneGeometry(1, length, 1, resolution);\n    var material = new THREE.MeshBasicMaterial({\n      color: color,\n      side: THREE.DoubleSide,\n      wireframe: !1,\n      transparent: !0,\n      opacity: 0.2\n    });\n    trail.mesh = new THREE.Mesh(geometry, material);\n    trail.mesh.position.add(offset);\n    this.el.sceneEl.object3D.add(trail.mesh);\n    this.trails.haveTrails.push(object);\n    trail.mesh.frustumCulled = !1;\n    trail.trailHistory = [];\n    trail.trailVertices = [];\n    for (var i = 0; i < resolution + 1; i++) {\n      trail.trailVertices[i] = [];\n    }\n    for (var i = 0; i < trail.trailVertices.length; i++) {\n      trail.trailVertices[i][0] = trail.mesh.geometry.vertices[i * 2];\n      trail.trailVertices[i][1] = trail.mesh.geometry.vertices[i * 2 + 1];\n    }\n  },\n  updateTrailHistory: function updateTrailHistory(object) {\n    object.userData.trails.forEach(trail => {\n      object.getWorldDirection(trail.worldDirection);\n      trail.trailHistory.push([\n        object.position.x,\n        object.position.y,\n        object.position.z,\n        trail.worldDirection.x,\n        trail.worldDirection.z\n      ]);\n      if (trail.trailHistory.length > trail.length) {\n        trail.trailHistory.shift();\n      }\n    });\n  },\n  updateTrails: function updateTrails() {\n    for (let i = 0; i < this.trails.haveTrails.length; i++) {\n      const object = this.trails.haveTrails[i];\n      this.updateTrailHistory(object);\n      object.userData.trails.forEach(trail => {\n        for (var j = 0; j < trail.trailVertices.length; j++) {\n          var index = Math.round(\n            (trail.trailHistory.length / trail.resolution) * j\n          );\n          if (index === trail.trailHistory.length) {\n            index = trail.trailHistory.length - 1;\n          }\n          var pos = trail.trailHistory[index];\n          var width =\n            (THREE.Math.mapLinear(j, 0, trail.trailVertices.length, 0, 1) *\n              trail.width) /\n            2;\n          if (typeof pos != \"undefined\") {\n            trail.trailVertices[j][0].x = pos[0] - pos[4] * width;\n            trail.trailVertices[j][0].y = pos[1];\n            trail.trailVertices[j][0].z = pos[2] + pos[3] * width;\n            trail.trailVertices[j][1].x = pos[0] + pos[4] * width;\n            trail.trailVertices[j][1].y = pos[1];\n            trail.trailVertices[j][1].z = pos[2] - pos[3] * width;\n          }\n        }\n        trail.mesh.geometry.verticesNeedUpdate = !0;\n      });\n    }\n  },\n  resetTrail: function resetTrail(object) {\n    object.userData.trails.forEach(trail => {\n      trail.trailHistory = [];\n    });\n  },\n  tick: function(t, dt) {\n    this.updateTrails();\n  }\n});\nAFRAME.registerComponent(\"trail\", {\n  schema: {\n    length: { default: 80 },\n    width: { default: 0.8 },\n    resolution: { default: 18 },\n    color: { default: \"white\" },\n    offset: { type: \"vec3\" }\n  },\n  multiple: !0,\n  init: function() {\n    console.log('Creating a trail.  The value of this is: ', this)\n    this.system.createTrail(\n      this.el.object3D,\n      this.data.length,\n      this.data.width,\n      this.data.resolution,\n      this.data.color,\n      this.data.offset\n    );\n  },\n  reset: function() {\n    this.system.reset(this.el.object3D);\n  }\n});\n\n\n\nconst instances = document.createElement('gltf-instances');\nCS1.add(instances);\nCS1.myPlayer.setAttribute('jump','speed:25');\nCS1.create('a-jukebox').then(o=>{\n  window.jukebox=o \n  o.setAttribute('position','0 3.1 -10')\n  o.setAttribute('scale','4 4 4')\n  CS1.scene.appendChild(o);\n})\nCS1.registerComponent('circle-movement', {\n  schema: {\n    center: {type: 'vec3'},\n    speed: {default: 1},\n    radius: {default: 20},\n    reverse: {default: false}\n  },\n  \n  init: function(){\n    this.dir=this.data.reverse?1:-1;\n  },\n  \n  tick: function(t,dt){\n    // x = rCos(theta)   y = rSin(theta)\n    const x = this.data.center.x+this.data.radius*Math.cos(this.dir*t*this.data.speed/1000);\n    const y = this.data.center.y;\n    const z = this.data.center.z+this.data.radius*Math.sin(this.dir*t*this.data.speed/1000);\n    this.el.object3D.position.set(x, y, z);\n  }\n  \n});\nasync function addCircleFlyer(color,center,reverse,speed){\n    const s = await CS1.create('a-sphere');\n    s.setAttribute('trail__red','color:red; offset:-1 0 0');\n    s.setAttribute('trail__white','color:white; length:120');\n    s.setAttribute('trail__blue','color:blue; offset:1 0 0');\n    s.setAttribute('color',color);\n    s.setAttribute('radius', 0.5);\n    s.setAttribute('circle-movement',`center:${center}; radius: 6;reverse:${reverse};speed:${speed}`);\n    CS1.scene.appendChild(s);\n    \n}\naddCircleFlyer('blue','0 6 -20',false,1);\naddCircleFlyer('red','-4 4 -15',true,1.5);\naddCircleFlyer('white','4 8 -25',true,0.6);\nCS1.game.addEnvironment();\nCS1.game.start();\n\n\n\n\n\n\n\n\n"],"names":["AFRAME","registerSystem","schema","init","trails","haveTrails","createTrail","object","length","width","resolution","color","offset","userData","trail","Math","round","trailHistory","trailVertices","worldDirection","THREE","Vector3","push","geometry","PlaneGeometry","material","MeshBasicMaterial","side","DoubleSide","wireframe","transparent","opacity","mesh","Mesh","position","add","this","el","sceneEl","object3D","frustumCulled","i","vertices","updateTrailHistory","forEach","getWorldDirection","x","y","z","shift","updateTrails","j","index","pos","mapLinear","verticesNeedUpdate","resetTrail","tick","t","dt","registerComponent","default","type","multiple","console","log","system","data","reset","instances","document","createElement","async","addCircleFlyer","center","reverse","speed","s","CS1","create","setAttribute","scene","appendChild","myPlayer","then","o","window","jukebox","radius","dir","cos","sin","set","game","addEnvironment","start"],"mappings":"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"}